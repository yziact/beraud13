<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <!-- Inherit Form View to Modify it -->
    <record id="oppor_form_action_com" model="ir.ui.view">
        <field name="name">Opportunités Actions Commerciales</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">

            <xpath expr="//div[@name='button_box']" position="inside">
                <button class="oe_stat_button" type="object" icon="fa-clock-o"  name="action_view_action">
                    <field name="action_count" string="Actions" widget="statinfo" />
                </button>
            </xpath>

            <xpath expr="//field[@name='date_deadline']" position="before">
                <button name="action_create_action" string="Créer" type="object" class="btn-link" attrs="{'invisible':[('action_id','!=',0)]}"/>
                <button name="action_done_action" string="Terminer" type="object" class="btn-link" attrs="{'invisible':[('action_id','=',0)]}"/>
                <field name="action_id" groups="base.group_no_one"/>
            </xpath>

            <xpath expr="//button[@name='action_schedule_meeting']" position="attributes">
                <attribute name="invisible">True</attribute>
            </xpath>

        </field>
    </record>

    <!-- Inherit Form View to Modify it -->
    <record id="leads_form_action_com" model="ir.ui.view">
        <field name="name">Pistes Actions Commerciales</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
        <field name="arch" type="xml">

            <xpath expr="//div[@name='button_box']" position="inside">
                <button class="oe_stat_button" type="object" icon="fa-clock-o"  name="action_view_action">
                    <field name="action_count" string="Actions" widget="statinfo" />
                </button>
            </xpath>

        </field>
    </record>

    <record model="ir.actions.act_window" id="crm_lead_action_activities">
        <field name="name">Action Commerciale</field>
        <field name="res_model">crm_yziact.action</field>
        <field name="view_mode">tree,form</field>
        <field name="domain"/>
        <field name="context">
            {
            'default_user_id': uid,
            'search_default_user_id': uid,
            'search_default_group_by_regarde': 1,
            }
        </field>
        <field name="search_view_id" ref="module_action.action_com_search"/>
    </record>

</odoo>
